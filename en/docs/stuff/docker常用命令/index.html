<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.5">
<link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="Rain-Maker的成长之路 Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="Rain-Maker的成长之路 Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Rain-Maker的成长之路" href="/en/opensearch.xml"><title data-react-helmet="true">docker常用命令 | Rain-Maker的成长之路</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://lrqwriting.top/en/docs/stuff/docker常用命令"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="docker常用命令 | Rain-Maker的成长之路"><meta data-react-helmet="true" name="description" content="前言"><meta data-react-helmet="true" property="og:description" content="前言"><link data-react-helmet="true" rel="shortcut icon" href="/en/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://lrqwriting.top/en/docs/stuff/docker常用命令"><link data-react-helmet="true" rel="alternate" href="https://lrqwriting.top/en/docs/stuff/docker常用命令" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://lrqwriting.top/docs/stuff/docker常用命令" hreflang="zh-cn"><link data-react-helmet="true" rel="alternate" href="https://lrqwriting.top/docs/stuff/docker常用命令" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://ZABUFQBOIA-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/en/assets/css/styles.22bcbf3e.css">
<link rel="preload" href="/en/assets/js/runtime~main.e276dac0.js" as="script">
<link rel="preload" href="/en/assets/js/main.6bf9437e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><img src="/en/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/en/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">主页</b></a><a class="navbar__item navbar__link navbar__link--active" href="/en/docs/intro">文章</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/RainMaker-Q" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/en/docs/intro">欢迎来到我的博客！</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">一些有趣的项目</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">乱七八糟</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/stuff/nginx的一些tips">nginx的一些tips</a></li><li class="menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/stuff/docker常用命令">docker常用命令</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/stuff/git回顾及git flow思想">git的一些回顾,及git flow思想</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/stuff/校园网无限流量总结">校园网的无限流量</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">前端零食</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">算法</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">学习笔记</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">一些动效</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1>docker常用命令</h1></header><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="前言"></a>前言<a class="hash-link" href="#前言" title="Direct link to heading">#</a></h3><p>最近做了一小套前后端系统，vue+koa+mysql，做了相关的监控页面。实验室都在搞docker，想起以前做项目的时候用过，现在再捡起来熟悉一下。把前后端项目都用docker部署了一下，写了dockerfile进行构建。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="一为什么要用docker"></a>一、为什么要用docker<a class="hash-link" href="#一为什么要用docker" title="Direct link to heading">#</a></h3><ol><li><p>解决一个问题：<strong>「为什么会出问题呢?在我的电脑上运行没问题啊!」</strong></p></li><li><p>环境的快速部署，提高运维人员效率。</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="二一些概念"></a>二、一些概念<a class="hash-link" href="#二一些概念" title="Direct link to heading">#</a></h3><p>镜像(image)：从Docker Hub拉取下来镜像，每次运行镜像，docker会生成一个容器承载镜像。如nginx镜像，nodejs镜像。</p><p>容器(container)：容器与容器之间是隔离的，可以通过shell进入容器内部，类似一个小型的linux。</p><p>镜像与容器的关系就像是：类和对象的关系。</p><p>虚拟机和docker容器的区别：</p><ul><li><p>对于虚拟机而言，server之上运行操作系统，在操作系统内再运行一个application，这个application包含了新的操作系统、libs、apps。</p></li><li><p>对于docker容器而言，server之上运行操作系统，在操作系统上运行容器，容器内没有额外的操作系统，只包含一些libs、apps，而且容器之间是互相隔离的。</p></li></ul><p><img src="https://github.com/LRQLRQ/picture/blob/master/docker_p1.png?raw=true" alt="avatar">
<img src="https://github.com/LRQLRQ/picture/blob/master/docker_p2.png?raw=true" alt="avatar"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="三常用的命令"></a>三、常用的命令<a class="hash-link" href="#三常用的命令" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic"># 查看进程</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -a        </span><span class="token comment" style="color:#999988;font-style:italic"># 查看所有进程</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker </span><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> -aq       </span><span class="token comment" style="color:#999988;font-style:italic"># 查看所有容器的id</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -itd </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image_name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 生成一个容器来运行镜像</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker stop </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">container </span><span class="token function" style="color:#d73a49">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic"># 关闭一个容器</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker start </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">container </span><span class="token function" style="color:#d73a49">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">     </span><span class="token comment" style="color:#999988;font-style:italic"># 打开容器</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker restart </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">container </span><span class="token function" style="color:#d73a49">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># 重启容器</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker </span><span class="token function" style="color:#d73a49">rm</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">container </span><span class="token function" style="color:#d73a49">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 删除容器</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker images       </span><span class="token comment" style="color:#999988;font-style:italic"># 查看所有镜像</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker rmi </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image </span><span class="token function" style="color:#d73a49">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic"># 删除镜像</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker </span><span class="token function" style="color:#d73a49">cp</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">container </span><span class="token function" style="color:#d73a49">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">:/home/filename ~/  </span><span class="token comment" style="color:#999988;font-style:italic"># 将文件从容器内移动到容器外部</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="四容器数据卷"></a>四、容器数据卷<a class="hash-link" href="#四容器数据卷" title="Direct link to heading">#</a></h3><p>如果数据都在容器内部，当容器使用完删除掉，数据就会丢失。</p><p>需要将Mysql之类的数据可以存储到本地！</p><p>容器之间需要有一个数据共享的技术，docker容器中产生的数据，可以同步到本地。=》卷技术。</p><p>将容器内的目录，挂载到linux宿主机上。</p><p><strong>最终需求：容器的持久化和同步操作！容器间也是可以数据共享的</strong></p><p>匿名挂载： -v 容器内路径</p><p>具名挂载： -v 卷名：容器内路径</p><p>指定路径挂载： -v /宿主机路径：容器内路径</p><p>如果指定了路径，就按照指定的路径挂载。没有指定路径，看是具名还是匿名的挂载。可以通过<code>docker volume ls</code>查看，位置都是在<code>/var/lib/docker/volumes</code>内。</p><p>docker容器内的卷，具名挂载，没有指定目录的情况下都是在<code>/var/lib/docker/volumes</code>内。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 一旦设置了容器的权限，容器对我们挂载出来的内容就有限制了。</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d -P --name nginx001 -v volum-nginx:/etc/nginx:rw nginx </span><span class="token comment" style="color:#999988;font-style:italic"># 可读可写</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d -P --name nginx001 -v volum-nginx:/etc/nginx:ro nginx </span><span class="token comment" style="color:#999988;font-style:italic"># 只读</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ro代表只能由宿主机改变，容器内部无法操作。</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>除了容器和宿主机之间可以数据共享，容器之间也可以数据共享</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># -it 表示交互</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># --name表示命名</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># -v表示挂载目录，宿主机目录:容器内目录</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it --name docker01 -v /home/ceshi:/home/ceshi   centos /bin/bash    </span><span class="token comment" style="color:#999988;font-style:italic"># 以centos为镜像，命名docker01容器</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /home/ceshi  </span><span class="token function" style="color:#d73a49">touch</span><span class="token plain"> docker01  </span><span class="token comment" style="color:#999988;font-style:italic"># 执行完上面的命令会进入docker01容器，在ceshi目录下新建docker01文件</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">exit</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 退出容器</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run -it --name docker02 --volumes-from docker01 centos /bin/bash     </span><span class="token comment" style="color:#999988;font-style:italic"># 以centos为镜像，挂载卷容器</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /home/ceshi  </span><span class="token function" style="color:#d73a49">touch</span><span class="token plain"> docker02  </span><span class="token comment" style="color:#999988;font-style:italic"># 进入容器名为docker02的容器，里面已经存在docker01文件，同时新建docker01文件</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">exit</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 退出容器</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> /home/ceshi </span><span class="token comment" style="color:#999988;font-style:italic"># 进入宿主机的/home/ceshi目录，发现docker01和docker02文件</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="五dockerfile"></a>五、Dockerfile<a class="hash-link" href="#五dockerfile" title="Direct link to heading">#</a></h3><p>DOckerfile就是用来构建docker镜像的构建脚本！</p><p>构建步骤：</p><ol><li>编写一个dockerfile文件</li><li>docker build构建成为一个镜像</li><li>docker run运行镜像</li><li>docker push 发布镜像(DockerHub、阿里云仓库镜像)</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="dockerfile的指令"></a>DockerFile的指令<a class="hash-link" href="#dockerfile的指令" title="Direct link to heading">#</a></h4><hr><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">FROM        </span><span class="token comment" style="color:#999988;font-style:italic"># 基础镜像，一切从这个镜像开始</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">MAINTAINER  </span><span class="token comment" style="color:#999988;font-style:italic"># 镜像的维护者是谁，姓名+邮箱</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN         </span><span class="token comment" style="color:#999988;font-style:italic"># 镜像构建的时候需要运行的命令</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR         </span><span class="token comment" style="color:#999988;font-style:italic"># 镜像的工作目录</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">VOLUME          </span><span class="token comment" style="color:#999988;font-style:italic"># 挂载的目录</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE          </span><span class="token comment" style="color:#999988;font-style:italic"># 保留端口的配置</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD                 </span><span class="token comment" style="color:#999988;font-style:italic"># 指定这个容器启动的时候，要执行的命令，只有最后一个会生效，可以被替代</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT  </span><span class="token comment" style="color:#999988;font-style:italic"># 指定这个容器启动的时候，要执行的命令，可以追加命令</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ONBUILD         </span><span class="token comment" style="color:#999988;font-style:italic"># 当构建一个被继承 DockerFile 这个时候就会运行 ONBUILD 的指令，触发指令</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY                </span><span class="token comment" style="color:#999988;font-style:italic"># 类似ADD， 将我们的文件拷贝到镜像</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV                 </span><span class="token comment" style="color:#999988;font-style:italic"># 构建的时候设置环境变量</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>可以通过history命令查看镜像的构建过程。</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">docker </span><span class="token function" style="color:#d73a49">history</span><span class="token plain"> imageid</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>CMD命令和ENTRYPOINT命令的区别？</p></blockquote><p>在dockerfile内，CMD和ENTYRPOINT命令都是期望在容器运行后执行的指令。</p><p>使用CMD构建的镜像，运行镜像时添加的参数会把指令覆盖。</p><p>使用ENTRYPOINT构建的镜像，运行镜像时添加的参数会累加到dockerfile内的命令后面。</p><p>case：</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># CMD指令的dockerfile</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM centos</span></span><span class="token-line" style="color:#393A34"><span class="token plain">CMD </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;ls -a&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker build -f dockerfile -t testcmd </span><span class="token builtin class-name">.</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># 构建镜像</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run testcmd -l       </span><span class="token comment" style="color:#999988;font-style:italic"># 报错</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run testcmd </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -al   </span><span class="token comment" style="color:#999988;font-style:italic"># 显示目录所有详细条目</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># ENTRYPOINT的dockerfile</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM centos</span></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;ls&quot;</span><span class="token plain">,</span><span class="token string" style="color:#e3116c">&quot;-a&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker build -f dockerfile -t testentrypoint </span><span class="token builtin class-name">.</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 构建镜像</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">docker run testentrypoint -l    </span><span class="token comment" style="color:#999988;font-style:italic"># 显示目录所有详细条目</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="编写dockerfile"></a>编写dockerfile<a class="hash-link" href="#编写dockerfile" title="Direct link to heading">#</a></h4><p>编写dockerfile文件，官方命名<code>Dockerfile</code>，build会自动找这个文件进行构建。就不需要<code>-f</code>指定了。</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="六docker网络"></a>六、docker网络<a class="hash-link" href="#六docker网络" title="Direct link to heading">#</a></h3><p>在宿主机使用docker每生成一个容器，都会生成一对网卡。在宿主机使用<code>ping</code>命令可以<code>ping</code>通容器内的网络。</p><p><code>veth-pair</code>是一对虚拟设备接口，都是成对出现的，一段连着协议，一段彼此相连。</p><p><code>veth-pair</code>充当一个桥梁，连接各种虚拟网络设备。</p><p>当容器删除掉，对应的一对网桥就没了。</p><hr><p>written by Rain
2020.10.05</p></div><footer class="docusaurus-mt-lg"><div class="row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/en/docs/tags/docker">docker</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/en/docs/stuff/nginx的一些tips"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« nginx的一些tips</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/en/docs/stuff/git回顾及git flow思想"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">git的一些回顾,及git flow思想 »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#前言" class="table-of-contents__link">前言</a></li><li><a href="#一为什么要用docker" class="table-of-contents__link">一、为什么要用docker</a></li><li><a href="#二一些概念" class="table-of-contents__link">二、一些概念</a></li><li><a href="#三常用的命令" class="table-of-contents__link">三、常用的命令</a></li><li><a href="#四容器数据卷" class="table-of-contents__link">四、容器数据卷</a></li><li><a href="#五dockerfile" class="table-of-contents__link">五、Dockerfile</a></li><li><a href="#六docker网络" class="table-of-contents__link">六、docker网络</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Blog, Inc.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.e276dac0.js"></script>
<script src="/en/assets/js/main.6bf9437e.js"></script>
</body>
</html>